/**
 * Minified by jsDelivr using UglifyJS v3.1.10.
 * Original file: /npm/lz4js@0.2.0/lz4.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function makeHashTable(){try{return new Uint32Array(hashSize)}catch(s){for(var r=new Array(hashSize),e=0;e<hashSize;e++)r[e]=0;return r}}function clearHashTable(r){for(var e=0;e<hashSize;e++)hashTable[e]=0}function makeBuffer(r){try{return new Uint8Array(r)}catch(i){for(var e=new Array(r),s=0;s<r;s++)e[s]=0;return e}}function sliceArray(r,e,s){if(void 0!==typeof r.buffer){if(Uint8Array.prototype.slice)return r.slice(e,s);var i=r.length;e=(e|=0)<0?Math.max(i+e,0):Math.min(e,i),s=(s=void 0===s?i:0|s)<0?Math.max(i+s,0):Math.min(s,i);for(var a=new Uint8Array(s-e),t=e,o=0;t<s;)a[o++]=r[t++];return a}return r.slice(e,s)}var xxhash=require("./xxh32.js"),util=require("./util.js"),minMatch=4,minLength=13,searchLimit=5,skipTrigger=6,hashSize=65536,mlBits=4,mlMask=(1<<mlBits)-1,runBits=4,runMask=(1<<runBits)-1,blockBuf=makeBuffer(5<<20),hashTable=makeHashTable(),magicNum=407708164,fdContentChksum=4,fdContentSize=8,fdBlockChksum=16,fdVersion=64,fdVersionMask=192,bsUncompressed=2147483648,bsDefault=7,bsShift=4,bsMask=7,bsMap={4:65536,5:262144,6:1048576,7:4194304};exports.compressBound=function(r){return r+r/255+16|0},exports.decompressBound=function(r){var e=0;if(util.readU32(r,e)!==magicNum)throw new Error("invalid magic number");e+=4;var s=r[e++];if((s&fdVersionMask)!==fdVersion)throw new Error("incompatible descriptor version "+(s&fdVersionMask));var i=0!=(s&fdBlockChksum),a=0!=(s&fdContentSize),t=r[e++]>>bsShift&bsMask;if(void 0===bsMap[t])throw new Error("invalid block size "+t);var o=bsMap[t];if(a)return util.readU64(r,e);e++;for(var n=0;;){var f=util.readU32(r,e);if(e+=4,n+=f&bsUncompressed?f&=~bsUncompressed:o,0===f)return n;i&&(e+=4),e+=f}},exports.makeBuffer=makeBuffer,exports.decompressBlock=function(r,e,s,i,a){var t,o,n,f,u;for(n=s+i;s<n;){var m=r[s++],c=m>>4;if(c>0){if(15===c)for(;;)if(c+=r[s],255!==r[s++])break;for(f=s+c;s<f;)e[a++]=r[s++]}if(s>=n)break;if(t=15&m,o=r[s++]|r[s++]<<8,15===t)for(;;)if(t+=r[s],255!==r[s++])break;for(f=(u=a-o)+(t+=minMatch);u<f;)e[a++]=0|e[u++]}return a},exports.compressBlock=function(r,e,s,i,a){var t,o,n,f,u,m,c,l;if(m=0,c=i+s,o=s,i>=minLength)for(var h=3+(1<<skipTrigger);s+minMatch<c-searchLimit;){var k=util.readU32(r,s),p=util.hashU32(k)>>>0;if(p=(p>>16^p)>>>0&65535,t=a[p]-1,a[p]=s+1,t<0||s-t>>>16>0||util.readU32(r,t)!==k)s+=h++>>skipTrigger;else{for(h=3+(1<<skipTrigger),u=s-o,f=s-t,t+=minMatch,n=s+=minMatch;s<c-searchLimit&&r[s]===r[t];)s++,t++;var d=(n=s-n)<mlMask?n:mlMask;if(u>=runMask){for(e[m++]=(runMask<<mlBits)+d,l=u-runMask;l>=255;l-=255)e[m++]=255;e[m++]=l}else e[m++]=(u<<mlBits)+d;for(var b=0;b<u;b++)e[m++]=r[o+b];if(e[m++]=f,e[m++]=f>>8,n>=mlMask){for(l=n-mlMask;l>=255;l-=255)e[m++]=255;e[m++]=l}o=s}}if(0===o)return 0;if((u=c-o)>=runMask){for(e[m++]=runMask<<mlBits,l=u-runMask;l>=255;l-=255)e[m++]=255;e[m++]=l}else e[m++]=u<<mlBits;for(s=o;s<c;)e[m++]=r[s++];return m},exports.decompressFrame=function(r,e){var s,i,a,t,o=0,n=0;if(util.readU32(r,o)!==magicNum)throw new Error("invalid magic number");if(o+=4,((t=r[o++])&fdVersionMask)!==fdVersion)throw new Error("incompatible descriptor version");s=0!=(t&fdBlockChksum),i=0!=(t&fdContentChksum),a=0!=(t&fdContentSize);var f=r[o++]>>bsShift&bsMask;if(void 0===bsMap[f])throw new Error("invalid block size");for(a&&(o+=8),o++;;){var u;if(u=util.readU32(r,o),o+=4,0===u)break;if(s&&(o+=4),0!=(u&bsUncompressed)){u&=~bsUncompressed;for(var m=0;m<u;m++)e[n++]=r[o++]}else n=exports.decompressBlock(r,e,o,u,n),o+=u}return i&&(o+=4),n},exports.compressFrame=function(r,e){var s=0;util.writeU32(e,s,magicNum),s+=4,e[s++]=fdVersion,e[s++]=bsDefault<<bsShift,e[s]=xxhash.hash(0,e,4,s-4)>>8,s++;var i=bsMap[bsDefault],a=r.length,t=0;for(clearHashTable(hashTable);a>0;){var o=0,n=a>i?i:a;if((o=exports.compressBlock(r,blockBuf,t,n,hashTable))>n||0===o){util.writeU32(e,s,2147483648|n),s+=4;for(var f=t+n;t<f;)e[s++]=r[t++];a-=n}else{util.writeU32(e,s,o),s+=4;for(var u=0;u<o;)e[s++]=blockBuf[u++];t+=n,a-=n}}return util.writeU32(e,s,0),s+=4},exports.decompress=function(r,e){var s,i;return void 0===e&&(e=exports.decompressBound(r)),s=exports.makeBuffer(e),(i=exports.decompressFrame(r,s))!==e&&(s=sliceArray(s,0,i)),s},exports.compress=function(r,e){var s,i;return void 0===e&&(e=exports.compressBound(r.length)),s=exports.makeBuffer(e),(i=exports.compressFrame(r,s))!==e&&(s=sliceArray(s,0,i)),s};
//# sourceMappingURL=/sm/ed028b45a4845367200f727931d52163f6e7cd0b94e4d10830a47b3810392873.map
